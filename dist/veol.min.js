!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Veol",[],t):"object"==typeof exports?exports.Veol=t():e.Veol=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=i(o),r=n(3),l=i(r),d=n(4),s=i(d),c=n(14),u=i(c),f=n(16),v=i(f),p=n(17),h=i(p),g=n(15),w=i(g),b={PageMaker:a.default,WidgetDefinition:l.default,Gui:{Tree:u.default,Preview:v.default,WidgetPropertiesEditor:h.default,WidgetCreator:w.default},utils:s.default,titleDetails:d.titleDetails};t.default=b,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=i(o),r=n(5),l=i(r),d=n(4),s=i(d),c=1e4,u=function(){this.widgets={},this.addWidgetDefinition("widget-list",new a.default)};u.prototype.addWidgetDefinition=function(e,t){this.widgets[e]=t},u.prototype.findWidgetDefinition=function(e){var t=this.widgets[e];if(t)return t;throw"No widget named "+e+" was found"},u.prototype.parseData=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i={};if(i.data=e.data||{},i.meta=e.meta||{},i.editor=e.editor||{},i.wid=c++,i.parent=n,i.application=t,s.default.makeObservable(i,!0),e.widgetName&&(i.widgetName=e.widgetName,i.widgetDefinition=this.findWidgetDefinition(e.widgetName),i.helper={save:function(){return i.widgetDefinition.onSave(i)}},i.widgetDefinition.isContainer()))if(e.children&&e.children.length>0){i.children=[];for(var o in e.children)e.children.hasOwnProperty(o)&&(i.children[o]=this.parseData(e.children[o],t,i))}else i.children=[];return i},u.prototype.createApplication=function(e){return new l.default(this,e)},t.default=u,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),a=i(o);t.default=a.default.create({isContainer:!0,title:"Groupe",faIconName:"folder"}),e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(4),l=i(r),d=function(){function e(){o(this,e)}return a(e,[{key:"onSave",value:function(e){var t={widgetName:e.widgetName};if(this.isContainer()){t.children=[];for(var n in e.children)e.children.hasOwnProperty(n)&&t.children.push(e.children[n].helper.save())}return e.data&&Object.getOwnPropertyNames(e.data).length>0&&(t.data=e.data),e.meta&&Object.getOwnPropertyNames(e.meta).length>0&&(t.meta=e.meta),e.editor&&Object.getOwnPropertyNames(e.editor).length>0&&(t.editor=e.editor),t}},{key:"isContainer",value:function(){return this.config.isContainer===!0}},{key:"allowedAsChild",value:function(e){var t=void 0;return t=e.widgetDefinition?e.widgetDefinition.config.types:e.config.types,l.default.whitelistBlacklistChecker(this.config.childrenWhitelist,this.config.childrenBlacklist,t)}},{key:"allowedAsParent",value:function(e){var t=void 0;return t=e.widgetDefinition?e.widgetDefinition.config.types:e.config.types,l.default.whitelistBlacklistChecker(this.config.parentWhitelist,this.config.parentBlacklist,t)}}]),e}();d.create=function(e){e=e||{};var t=function(){this.config=e,this.config.data=this.config.data||{}};return t.prototype=Object.create(d.prototype),t},d.fastInstance=function(e){var t=d.create(e);return new t},t.default=d,e.exports=t.default},function(e,t){"use strict";function n(){var e=!1,t={stop:function(){e=!0},isStopped:function(){return e}};return t}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,n){if(e.parent){var i=e.parent.children.indexOf(e);e.parent.children.splice(i,1),n===e.parent&&t>=i&&t--}n.children.splice(t,0,e),e.parent=n},o=function(e,t){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1},a=function(e){return"<span class='veol-title-details'>"+e+"</span>"};t.titleDetails=a,t.default={makeObservable:function(e,t){var i;i=t?e:e.prototype,i.addEventListener=function(e,n){var o=t?i:this;o.hasOwnProperty("__veol_callbacks")||(o.__veol_callbacks={}),o.__veol_callbacks.hasOwnProperty(e)||(o.__veol_callbacks[e]=[]),o.__veol_callbacks[e].push(n)},i.removeEventListener=function(e,n){var o=t?i:this;if(o.hasOwnProperty("__veol_callbacks")&&o.__veol_callbacks.hasOwnProperty(e))for(var a=o.__veol_callbacks[e].length-1;a>=0;a--)o.__veol_callbacks[e][a]===n&&o.__veol_callbacks[e].splice(a,1)},i.dispatchEvent=function(e,o){var a=t?i:this,r=n();if(a.hasOwnProperty("__veol_callbacks")&&a.__veol_callbacks.hasOwnProperty(e))for(var l=0;l<a.__veol_callbacks[e].length&&(a.__veol_callbacks[e][l].apply(r,o),!r.isStopped());l++);}},insertWidgetBefore:function(e,t){var n=e.parent;if(!n)throw"target widget has no parent";if(!n.children)throw"target widget has invalid parent (no children registered)";var o=n.children.indexOf(e);if(o===-1)throw"target widget has invalid parent (widget not found in parent)";i(t,o,n)},insertWidgetAfter:function(e,t){var n=e.parent;if(!n)throw"target widget has no parent";if(!n.children)throw"target widget has invalid parent (no children registered)";var o=n.children.indexOf(e)+1;if(o===-1)throw"target widget has invalid parent (widget not found in parent)";i(t,o,n)},appendWidget:function(e,t){if(!e.children)throw"target widget has invalid parent (no children registered)";i(t,e.children.length,e)},insertWidgetAt:i,domIndexOf:function(e,t){return Array.prototype.indexOf.call(t.children,e)},arrayContainsOneOf:o,whitelistBlacklistChecker:function(e,t,n){return n=n||[],!(t&&t.length>0&&o(t,n))&&(!(e&&e.length>0)||o(e,n))},getPropertyEditor:function(e,t){var n=e.editor||"textfield";if("string"==typeof n){var i=t.findEditor(n);if(!i)throw"Unknown editor "+n;return i}return n},bindModal:function(e,t){e.find("[veol-close]").click(function(){t()})}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(4),d=i(l),s=n(6),c=i(s),u=n(13),f=i(u),v=function(){function e(t,n){o(this,e),this.pageMaker=t,this.originalData=n,this.data=t.parseData(n,this,null),this.selectedWidget=[],this.editorPool=new c.default({loadDefaults:!0}),this.yesNo=new f.default}return r(e,[{key:"save",value:function(){return this.data.helper.save()}},{key:"reload",value:function(){var e=this.save();this.data=pageMaker.parseData(e,this,null)}},{key:"deleteWidget",value:function(e){var t=e.parent.children.indexOf(e);t>0&&e.parent.children.splice(t,1),this.dispatchEvent("widgetDeleted",[e])}},{key:"selectWidget",value:function(e){this.selectedWidget.push(e),this.dispatchEvent("widgetSelected",[e])}},{key:"unselectAllWidgets",value:function(){this.selectedWidget=[],this.dispatchEvent("unselectAllWidgets",[])}},{key:"updateWidgetData",value:function(e,t,n){this.getWidget(e).data[t]=n,this.dispatchEvent("widgetDataEdited",[e,t,n]),e.dispatchEvent("dataEdited",[t,n])}},{key:"updateWidgetMeta",value:function(e,t,n){this.getWidget(e).meta[t]=n,this.dispatchEvent("widgetMetaEdited",[e,t,n]),e.dispatchEvent("metaEdited",[t,n])}},{key:"updateWidgetEditorProperty",value:function(e,t,n){this.getWidget(e).editor[t]=n,this.dispatchEvent("widgetEditorPropertyEdited",[e,t,n]),e.dispatchEvent("editorPropertyEdited",[t,n])}},{key:"getWidgetEditorProperty",value:function(e,t){return this.getWidget(e).editor[t]}},{key:"getWidget",value:function(e){if("object"===("undefined"==typeof e?"undefined":a(e)))return e;throw"Unable to find a widget by id: not implemented yet"}},{key:"createWidget",value:function(e,t,n){var i=this.pageMaker.parseData(widgetData,this,inWidget);inWidget&&inWidget.children.push(i),this.dispatchEvent("widgetCreated",[i])}}]),e}();d.default.makeObservable(v),t.default=v,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){e.addEditor(["textField","textfield"],new d.default),e.addEditor(["text","textArea"],new c.default),e.addEditor(["select"],new f.default),e.addEditor(["range"],new p.default)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(7),d=i(l),s=n(10),c=i(s),u=n(11),f=i(u),v=n(12),p=i(v),h=function(){function e(t){o(this,e),t=t||t,this.editors=[],t.loadDefaults&&a(this)}return r(e,[{key:"addEditor",value:function(e,t){this.editors.push({names:e,editor:t})}},{key:"findEditor",value:function(e){for(var t=0;t<this.editors.length;t++)if(this.editors[t].names.indexOf(e)>-1)return this.editors[t].editor;return null}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(8),s=i(d),c=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"getInput",value:function(){return $('<input type="text" />')}}]),t}(s.default);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(9),s=i(d),c=function(e){function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{isLiveEdit:!0})),n=e;return e.config.onCreateEditor=function(e,t,i){var o=n.getInput(e,t,i);o.on("input",function(){t.application.updateWidgetData(t,i.name,o.val())}),e.data("veol-get-value",function(){return o.val()});var a=t.data[i.name];a&&o.val(a),t.addEventListener("dataEdited",function(e,t){e==i.name&&o.val(t)}),n.drawEditor(e,o,t,i)},e}return r(t,e),l(t,[{key:"drawEditor",value:function(e,t,n,i){e.append(t,n,i)}},{key:"getInput",value:function(e,t,n){throw"This method is abstract and should be overriden by extending class"}}]),t}(s.default);t.default=c,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t){n(this,e),this.config=t||{}}return o(e,[{key:"createEditor",value:function(e,t){var n=$('<div class="veol-widget-editor-group"/>');return this.config.onCreateEditor&&this.config.onCreateEditor(n,e,t),n}},{key:"isLiveEdit",value:function(){return this.config.isLiveEdit===!0}},{key:"getValue",value:function(e){var t=e.data("veol-get-value");if("function"==!("undefined"==typeof t?"undefined":i(t)))throw"Editor did not implement get value";return t()}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(8),s=i(d),c=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"getInput",value:function(e,t,n){return $("<textarea/>")}},{key:"isLiveEdit",value:function(){return!1}}]),t}(s.default);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(8),c=i(s),u=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),d(t,[{key:"getInput",value:function(e,t,n){var i=$("<select />");n.multiple&&i.prop("multiple",!0);for(var o=0;o<n.options.length;o++){var a=n.options[o],r="undefined"==typeof a?"undefined":l(a);"string"==r||"number"==r?i.append('<option value="'+a+'" >'+a+"</option>"):i.append('<option value="'+a.value+'" >'+a.label+"</option>")}return i}}]),t}(c.default);t.default=u,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(8),s=i(d),c=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"getInput",value:function(e,t,n){var i=n.min||0,o=n.max||i+100,a=n.step||1;return $('<input type="range" min="'+i+'" max="'+o+'" step="'+a+'" />')}},{key:"drawEditor",value:function(e,t,n,i){var o=$('<span class="veol-range-preview"></span>');o.html(t.val()),e.addClass("veol-combined-range"),e.append(o),e.append(t),n.addEventListener("dataEdited",function(e,t){e==i.name&&o.html(t)})}}]),t}(s.default);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(4),l=i(r),d=function(){function e(t){o(this,e),this.application=t,this.$root=$('\n          <div class="veol-modal">\n            <div class="veol-modal-background"></div>\n            <div class="veol-modal-display-area veol-controls">\n                <div class="veol-modal-header">\n                    <div class="veol-modal-title">Confirmer</div>\n                    <div veol-close><i class="fa fa-times fa-fw"></i></div>\n                </div>\n                <div class="veol-modal-content"></div>\n                <div class="veol-modal-footer">\n                    <div class="veol-button veol-button-validate">Oui</div>\n                    <div class="veol-button veol-button-cancel">Non</div>\n                </div>\n            </div>         \n          </div>\n        '),this.$root.hide(),this.$modalContent=this.$root.find(".veol-modal-content");var n=this;l.default.bindModal(this.$root,function(){n.close()}),$("body").append(this.$root),this.$root.find(".veol-button-validate").click(function(){n.close(),console.log("kk"),n._yes&&n._yes()}),this.$root.find(".veol-button-cancel").click(function(){n.close(),n._no&&n._no()})}return a(e,[{key:"ask",value:function(e,t,n){this._yes=t,this._no=n,this.$modalContent.html(e),this.$root.show()}},{key:"close",value:function(){this.$root.hide()}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){var n;n=t.widgetDefinition.config.title?t.widgetDefinition.config.title:t.widgetName,t.widgetDefinition.config.getDescription&&(n+=" "+(0,s.titleDetails)(t.widgetDefinition.config.getDescription(t))),e.find(">.veol-title .veol-title-text").empty().append(n)}function r(e,t,n){var i=t.widgetDefinition,o=i.isContainer(),l=$('<li class="veol-tree-node" data-wid="'+t.wid+'"/>');l.appendTo(n),l.data("widget-instance",t);var d=$('<div draggable="true" class="veol-title"></div>');if(l.append(d),d.append('<span class="veol-title-text"></span>'),a(l,t),d.click(function(n){n.ctrlKey||e.application.unselectAllWidgets(t),e.application.selectWidget(t)}),o){var s=$('<div class="veol-folder"></div>');d.prepend(s),s.click(function(){l.toggleClass("open")});var u=$('<div class="veol-add"></div>');d.append(u),u.click(function(){e.widgetCreator.createForParent(t)}),l.addClass("is-container open");var f=$('<ul class="veol-children"/>');f.appendTo(l);for(var v=0;v<t.children.length;v++)r(e,t.children[v],f)}var p=$('<div class="veol-menu-delete"></div>');d.append(p),p.click(function(){var n="Supprimer le widget ?";t.widgetDefinition.isContainer()&&(n+="<br/>Les sous widgets seront également supprimés"),e.application.yesNo.ask(n,function(){e.application.deleteWidget(t)})}),d.prepend('<div class="veol-tree-fill"></div>');var h=function(e){var t=e.parent(".veol-tree-node");t.removeClass("veol-drag-over"),t.removeClass("veol-can-drop-next"),t.removeClass("veol-can-drop-inside"),t.removeClass("veol-will-drop-before"),t.removeClass("veol-will-drop-after"),t.removeClass("veol-will-drop-inside")};d.on("dragstart",function(t){e.$dragging=l,l.addClass("veol-dragging"),e.$tree.addClass("veol-tree-has-drag")}),d.on("dragend",function(t){e.$dragging=null,$(this).parent(".veol-tree-node").removeClass("veol-dragging"),e.$tree.removeClass("veol-tree-has-drag")}),d.on("dragenter",function(n){if(e.isDragging()){var i=d.closest(".veol-dragging");if(0===i.length){var a=!1,r=!1,l=e.getDraggedWidget();t.parent.widgetDefinition.allowedAsChild(l)&&l.widgetDefinition.allowedAsParent(t.parent)&&(a=!0,d.parent(".veol-tree-node").addClass("veol-can-drop-next")),o&&t.widgetDefinition.allowedAsChild(l)&&l.widgetDefinition.allowedAsParent(t)&&(r=!0,d.parent(".veol-tree-node").addClass("veol-can-drop-inside")),(r||a)&&d.parent(".veol-tree-node").addClass("veol-drag-over")}}}),d.on("dragleave",function(e){h(d)}),d.on("dragover",function(e){if(l.hasClass("veol-drag-over")){var n=l.offset(),i=e.clientY-n.top,a=100*i/d.outerHeight();d.parent(".veol-tree-node").removeClass("veol-will-drop-before"),d.parent(".veol-tree-node").removeClass("veol-will-drop-after"),d.parent(".veol-tree-node").removeClass("veol-will-drop-inside"),l.hasClass("veol-can-drop-inside")&&(a>30&&a<70||!l.hasClass("veol-can-drop-next"))?l.addClass("veol-will-drop-inside"):a<=50?l.addClass("veol-will-drop-before"):o&&t.children.length>0?l.hasClass("veol-can-drop-inside")?l.addClass("veol-will-drop-inside"):l.addClass("veol-will-drop-before"):l.addClass("veol-will-drop-after"),e.preventDefault()}}),d.on("drop",function(n){if(n.preventDefault(),l.hasClass("veol-drag-over")){var i=e.getDraggedWidget();if(i&&i!==t){var o=null;l.hasClass("veol-will-drop-before")?(c.default.insertWidgetBefore(t,i),o="before"):l.hasClass("veol-will-drop-after")?(c.default.insertWidgetAfter(t,i),o="after"):l.hasClass("veol-will-drop-inside")&&(c.default.appendWidget(t,i),o="inside"),o&&e.application.dispatchEvent("widgetMoved",[i,t,o])}h($(this))}})}function l(e,t){e.addEventListener("widgetMoved",function(e,n,i){var o=t.$tree.find("[data-wid="+n.wid+"]"),a=t.$tree.find("[data-wid="+e.wid+"]");switch(i){case"inside":a.appendTo(o.find(".veol-children").first());break;case"after":a.insertAfter(o);break;case"before":a.insertBefore(o);break;default:console.error("unknown operation type "+i)}}),e.addEventListener("widgetDeleted",function(e){t.$tree.find("[data-wid="+e.wid+"]").remove()}),e.addEventListener("widgetSelected",function(e){t.$tree.find("[data-wid="+e.wid+"]").addClass("veol-widget-selected")}),e.addEventListener("unselectAllWidgets",function(){t.$tree.find(".veol-widget-selected").removeClass("veol-widget-selected")}),e.addEventListener("widgetDataEdited",function(e,n,i){a(t.$tree.find("[data-wid="+e.wid+"]"),e)}),e.addEventListener("widgetAdded",function(n){var i,o=n.parent.wid;o==e.data.wid?i=t.$tree.find(".veol-root"):(i=t.$tree.find("[data-wid="+o+"]").find(".veol-children").first(),console.log(i)),r(t,n,i)})}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(4),c=i(s),u=n(15),f=i(u),v=function(){function e(t){o(this,e),this.$tree=$('<div class="veol-tree veol-toolbox"/>'),this.$dragging=null,this.application=t,this.$header=$('<div class="veol-toolbox-header" >\n                <ul>\n                    <li class="veol-title">Widgets</li>\n                    <li class="veol-fill"></li>\n                </ul>\n            </div>'),this.$tree.append(this.$header),this.widgetCreator=new f.default(t);var n=this,i=$('<li class="veol-action" veol-action="add-widget" title="Ajouter un widget"><i class="fa fa-plus fa-fw"></i></li>');this.$header.find(">ul").append(i),i.click(function(){n.widgetCreator.createForParent()}),this.draw(),l(t,this)}return d(e,[{key:"draw",value:function(){this.$tree.find(".veol-root").remove();var e=$('<ul class="veol-root veol-children"/>');e.appendTo(this.$tree);for(var t=this.application.data,n=0;n<t.children.length;n++)r(this,t.children[n],e)}},{key:"isDragging",value:function(){return null!==this.$dragging}},{key:"getDraggedElement",value:function(){return this.$dragging}},{key:"getDraggedWidget",value:function(){return this.$dragging.data("widget-instance")}}]),e}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){var n;n=t.config.title?t.config.title:e;var i;i=t.config.faIconName?'<i class="fa fa-lg fa-'+t.config.faIconName+'"></i>':'<i class="fa fa-lg fa-question-circle-o"></i>';var o=$('<div class="veol-button veol-button-large veol-button-widget" veol-widget-name="'+e+'">\n            <div class="veol-icon">'+i+'</div>\n            <span class="veol-widget-name">'+n+"</span>\n        </div>");return o}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(4),d=i(l),s=function(){function e(t){o(this,e),this.application=t,this.$root=$('\n          <div class="veol-modal veol-widget-creator">\n            <div class="veol-modal-background"></div>\n            <div class="veol-modal-display-area">\n                <div class="veol-modal-header">\n                    <div class="veol-modal-title">Ajouter un Widget</div>\n                </div>\n                <div class="veol-modal-content">\n                    <ul class="veol-creator-widgetlist"></ul>\n                </div>\n                <div class="veol-modal-footer">\n                    <div veol-close class="veol-button veol-button-cancel">Annuler</div>\n                    <div class="veol-button veol-button-validate">Valider</div>\n                </div>\n            </div>         \n          </div>\n        '),this.$root.hide(),this.$widgetList=this.$root.find(".veol-creator-widgetlist");var n=this;d.default.bindModal(this.$root,function(){n.$root.hide()}),$("body").append(this.$root),this.$root.find(".veol-button-validate").click(function(){if(!$(this).attr("disabled")){n.close();var e=n.$root.find(".veol-button-widget.veol-selected").attr("veol-widget-name"),t=$(this).data("veol-parent"),i=n.application.pageMaker.findWidgetDefinition(e),o={widgetName:e,data:{}},a=i.config.properties;if(a)for(var r=0;r<a.length;r++)a[r].hasOwnProperty("defaultValue")&&(o.data[a[r].name]=a[r].defaultValue);var l=n.application.pageMaker.parseData(o,n.application,t);t.children.push(l),n.application.dispatchEvent("widgetAdded",[l]),n.application.unselectAllWidgets(),n.application.selectWidget(l)}})}return r(e,[{key:"createForParent",value:function(e){e||(e=this.application.data);var t=e.widgetDefinition,n=this.application.pageMaker.widgets,i=[];for(var o in n)t.allowedAsChild(n[o])&&n[o].allowedAsParent(t)&&(i[o]=n[o]);this.$widgetList.empty();for(var o in i){var r=a(o,i[o]);this.$widgetList.append(r)}var l=this;this.$root.find(".veol-button-validate").attr("disabled",!0),this.$root.find(".veol-button-validate").data("veol-parent",e),this.$root.find(".veol-button-validate").html("Selectionnez un widget"),this.$widgetList.find(".veol-button-widget").click(function(){l.$widgetList.find(".veol-selected").removeClass("veol-selected"),$(this).addClass("veol-selected"),l.$root.find(".veol-button-validate").removeAttr("disabled",!0),l.$root.find(".veol-button-validate").html("Ajouter le widget")}),this.$root.show()}},{key:"close",value:function(){this.$root.hide()}}]),e}();t.default=s,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){var a=t.widgetDefinition,r=a.isContainer(),l=$('<div class="veol-preview-widget" data-wid="'+t.wid+'"/>'),d=a.config.preview||{};if(d.onCreateOuter&&d.onCreateOuter(l,t),l.appendTo(n),l.data("widget-instance",t),r){l.addClass("veol-is-container");var s=$('<div class="veol-preview-content veol-preview-children"/>');s.appendTo(l),d.onCreateContainer&&d.onCreateContainer(s,t),o(l,t);for(var c=0;c<t.children.length;c++)i(e,t.children[c],s)}else{var u=$('<div class="veol-preview-content"></div>');u.appendTo(l),o(l,t)}}function o(e,t){var n=t.widgetDefinition.config.preview;if(n&&n.onDataChange){var i=e.find(".veol-preview-content").first();n.onDataChange(e,i,t)}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){n(this,e),this.$root=$('<div \n                class="veol-preview"\n            />'),this.$device=$('<div class="veol-device-wrapper">\n                <div class="veol-device-top"></div>\n                <div class="veol-device-screen"></div>\n                <div class="veol-device-bottom"></div>\n            </div>'),this.$header=$('<div class="veol-toolbox-header" >\n                <ul>                    \n                    <li class="veol-list-inline">\n                        <div class="veol-label">Device:</div>\n                        <div class="veol-list-choices">\n                            <ul>\n                                <li class="device-button veol-active" data-device="small">\n                                    <i class="fa fa-mobile fa-fw"></i>\n                                </li>\n                                <li class="device-button" data-device="medium">\n                                    <i class="fa fa-tablet fa-fw"></i>\n                                </li>\n                                <li class="device-button" data-device="large">\n                                    <i class="fa fa-laptop fa-fw"></i>\n                                </li>\n                                <li class="device-button" data-device="xlarge">\n                                    <i class="fa fa-desktop fa-fw"></i>\n                                </li>\n                            </ul>\n                        </div>\n                    </li>\n                    \n                \n                    \n                    <li class="veol-fill"></li>\n                </ul>\n            </div>'),
this.$screen=this.$device.find(".veol-device-screen"),this.$root.append(this.$header),this.$root.append(this.$device),this.application=t,this.draw(),this.setDevice("small");var a=this;this.$header.find(".device-button").click(function(){var e=$(this).attr("data-device");a.setDevice(e)}),t.addEventListener("widgetMoved",function(e,t,n){var i=a.$root.find("[data-wid="+t.wid+"]"),o=a.$root.find("[data-wid="+e.wid+"]");switch(n){case"inside":o.appendTo(i.find(".veol-preview-children").first());break;case"after":o.insertAfter(i);break;case"before":o.insertBefore(i);break;default:console.error("unknown operation type "+n)}}),t.addEventListener("widgetDeleted",function(e){a.$root.find("[data-wid="+e.wid+"]").remove()}),t.addEventListener("widgetAdded",function(e){var n,o=e.parent.wid;n=o==t.data.wid?a.$screen:a.$root.find("[data-wid="+o+"]"),i(a,e,n)}),t.addEventListener("widgetSelected",function(e){a.$root.find("[data-wid="+e.wid+"]").addClass("veol-widget-selected")}),t.addEventListener("unselectAllWidgets",function(){a.$root.find(".veol-widget-selected").removeClass("veol-widget-selected")}),t.addEventListener("widgetDataEdited",function(e,t,n){o(a.$root.find("[data-wid="+e.wid+"]"),e)})}return a(e,[{key:"draw",value:function(){this.$screen.empty();for(var e=this.application.data,t=0;t<e.children.length;t++)i(this,e.children[t],this.$screen)}},{key:"setDevice",value:function(e){this.deviceMode=e;var t=this.$root.attr("veol-device");t&&this.$root.removeClass("veol-device-"+t),this.$root.addClass("veol-device-"+e),this.$root.attr("veol-device",e),this.$header.find(".device-button.veol-active").removeClass("veol-active"),this.$header.find(".device-button[data-device="+e+"]").addClass("veol-active")}}]),e}();t.default=r,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){e.$propertiesWrapper.children().hide();var n;if(e.__editorCache.hasOwnProperty(t.wid))n=e.__editorCache[t.wid],n.show();else{var i=t.widgetDefinition,o=i.config.properties||[];n=$("<div/>");for(var a=0;a<o.length;a++){var d=o[a],s=d.name,c=d.label||s,u=$('<div class="veol-editor-row" />');u.append($("<label>"+c+"</label>"));var f=r(d,t,u,e);u.append(f),d.tooltip&&u.append('<span class="veol-tooltip veol-tooltip-help-icon" data-tooltip="'+d.tooltip+'"></span>'),d.nullable&&l(d,f,t),n.append(u)}e.__editorCache[t.wid]=n,e.$propertiesWrapper.append(n)}}function r(e,t,n,i){var o=c.default.getPropertyEditor(e,i.editorPool);if(e.useDedicatedEditor||!o.isLiveEdit()){var a=new f.default(t,e),r=$('<div class="veol-dedicated-editor-button">Editer</div>');return r.click(function(){a.show()}),r}var l=o.createEditor(t,e);return l}function l(e,t,n){var i=$('<input type="checkbox"/>');i.insertBefore(t);var o=void 0===n.data[e.name]||null===n.data[e.name];o?t.hide():i.attr("checked",!0),i.on("change",function(){var t=n.application.getWidgetEditorProperty(n,"nullBackup");if(t=t||{},this.checked){var i;i=t[e.name]?t[e.name]:e.defaultIfNull?e.defaultIfNull:"",n.application.updateWidgetData(n,e.name,i)}else t[e.name]=n.data[e.name],n.application.updateWidgetEditorProperty(n,"nullBackup",t),n.application.updateWidgetData(n,e.name,null)}),n.addEventListener("dataEdited",function(n,o){n==e.name&&(null!==o?(t.show(),i.prop("checked",!0)):(i.prop("checked",!1),t.hide()))})}Object.defineProperty(t,"__esModule",{value:!0});var d=n(6),s=(i(d),n(4)),c=i(s),u=n(18),f=i(u),v=function e(t){o(this,e),this.__editorCache={},this.$root=$('<div class="veol-property-editor veol-controls veol-toolbox">\n                <div class="veol-toolbox-header">\n                    <ul>\n                        <li class="veol-title">Propriétés</li>\n                    </ul>\n                </div>\n            </div>'),this.$propertiesWrapper=$('<div class="veol-properties-wrapper"></div>'),this.$root.append(this.$propertiesWrapper),this.application=t,this.editorPool=t.editorPool;var n=this;t.addEventListener("widgetDeleted",function(e){n.$propertiesWrapper.children().hide()}),t.addEventListener("widgetSelected",function(e){a(n,e)}),t.addEventListener("unselectAllWidgets",function(e){n.$propertiesWrapper.children().hide()})};t.default=v,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(4),l=i(r),d=function(){function e(t,n){o(this,e),this.widget=t,this.property=n;var i=n.label||n.name;this.$root=$('\n          <div class="veol-modal">\n            <div class="veol-modal-background"></div>\n            <div class="veol-modal-display-area veol-controls">\n                <div class="veol-modal-header">\n                    <div class="veol-modal-title">Edition du champs '+i+'</div>\n                </div>\n                <div class="veol-modal-content"></div>\n                <div class="veol-modal-footer">\n                    <div class="veol-button veol-button-validate">Valider</div>\n                    <div veol-close class="veol-button veol-button-cancel">Annuler</div>\n                </div>\n            </div>         \n          </div>\n        '),this.$root.hide(),this.$modalContent=this.$root.find(".veol-modal-content");var a=l.default.getPropertyEditor(n,t.application.editorPool),r=a.createEditor(t,n);this.$modalContent.append(r);var d=this;l.default.bindModal(this.$root,function(){d.$root.hide(),d.cancel()}),$("body").append(this.$root),this.$root.find(".veol-button-validate").click(function(){d.close(),a.isLiveEdit()||a.getValue(r)})}return a(e,[{key:"show",value:function(){this.backupData=this.widget.data[this.property.name],this.$root.show()}},{key:"close",value:function(){this.$root.hide()}},{key:"cancel",value:function(){this.hasOwnProperty("backupData")&&(this.widget.application.updateWidgetData(this.widget,this.property.name,this.backupData),delete this.backupData)}}]),e}();t.default=d,e.exports=t.default}])});
//# sourceMappingURL=veol.min.js.map